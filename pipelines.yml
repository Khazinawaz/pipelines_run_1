pipelines:
  - name: AffinityGroupSeriesTest
    steps:
      - name: start
        type: Bash
        execution:
          onExecute:
            - printenv
            - echo "Executing step on ${steplet_id}"
            
      - name: step_a
        type: Bash
        configuration:
          inputSteps:
            - name: start
          affinityGroup: group_a
          priority: 1
        execution:
          onExecute:
            - printenv
            - echo "Executing step on ${steplet_id}"
      - name: step_a1
        type: Bash
        configuration:
          inputSteps:
            - name: step_a
          affinityGroup: group_a
          priority: 5
        execution:
          onExecute:
            - printenv
            - echo "Executing step on ${steplet_id}"
      - name: step_a2
        type: Bash
        configuration:
          inputSteps:
            - name: step_a
          affinityGroup: group_a
          priority: 6
        execution:
          onExecute:
            - printenv
            - echo "Executing step on ${steplet_id}"
      - name: step_b
        type: Bash
        configuration:
          inputSteps:
            - name: step_a1
            - name: step_a2
          affinityGroup: group_a
          priority: 2
        execution:
          onExecute:
            - printenv
            - echo "Executing step on ${steplet_id}"
      - name: step_b1
        type: Bash
        configuration:
          inputSteps:
            - name: step_b
          affinityGroup: group_a
          priority: 3
        execution:
          onExecute:
            - printenv
            - echo "Executing step on ${steplet_id}"
      - name: step_b2
        type: Bash
        configuration:
          inputSteps:
            - name: step_b1
          affinityGroup: group_a
          priority: 4
        execution:
          onExecute:
            - printenv
            - echo "Executing step on ${steplet_id}"

      - name: step_join
        type: Bash
        configuration:
          inputSteps:
            - name: step_b2            
        execution:
          onExecute:
              - printenv
              - echo "Executing step on ${steplet_id}"

      - name: step_c
        type: Bash
        configuration:
          inputSteps:
            - name: step_join
          affinityGroup: group_b
        execution:
          onExecute:
            - printenv
            - echo "Executing step on ${steplet_id}"

      - name: step_d
        type: Bash
        configuration:
          inputSteps:
            - name: step_join
          affinityGroup: group_b
        execution:
          onExecute:
            - printenv
            - echo "Executing step on ${steplet_id}"

              
              